<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Family Trees - Dashboard</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" rel="stylesheet">
  <link rel="stylesheet" href="../styles/theme.css" />
  <link rel="stylesheet" href="../styles/base.css" />
  <link rel="stylesheet" href="../styles/components.css" />
  <link rel="stylesheet" href="../styles/page-overrides.css" />
  <link rel="stylesheet" href="../styles/page-common.css" />
  <link rel="stylesheet" href="../styles/dashboard.css" />
</head>
<body class="dashboard-page">
  <header class="topbar app-header">
    <div class="brand-group">
      <button id="themeBtn" title="Switch theme" aria-label="Switch theme">
        <span class="material-symbols-outlined" aria-hidden="true">light_mode</span>
      </button>
      <div class="brand">Ancestrio</div>
    </div>
    <div class="controls controls-dashboard">
      <div class="user-info">
        <button id="storeBtn" title="Open store" aria-label="Open store">
          <span class="material-symbols-outlined" aria-hidden="true">shopping_bag</span>
          <span class="store-text">Store</span>
        </button>
        <button id="logoutBtn" title="Logout" aria-label="Logout">
          <span class="material-symbols-outlined" aria-hidden="true">logout</span>
          <span class="logout-text">Exit</span>
        </button>
      </div>
    </div>
  </header>

  <main class="dashboard-main">
    <div class="dashboard-container">
      <div class="dashboard-hero">
        <h2 id="dashboardTitle">Your Family Trees</h2>
        <div class="dashboard-hero-actions" style="display: none;">
          <button id="createTreeBtn" class="dashboard-fab" title="Create new tree" aria-label="Create new tree">
            <span class="material-symbols-outlined" aria-hidden="true">add</span>
            New Tree
          </button>
        </div>
      </div>

      <div id="treesGrid" class="trees-grid">
        <!-- Trees will be loaded here -->
      </div>

      <div id="emptyState" class="empty-state" style="display: none;">
        <span class="material-symbols-outlined empty-icon">account_tree</span>
        <h3>No family trees yet</h3>
        <p>Create your first family tree to get started</p>
        <button id="createTreeBtnEmpty" class="create-tree-btn-secondary">
          <span class="material-symbols-outlined">add</span>
          Create Your First Tree
        </button>
      </div>

      <div id="loadingState" class="loading-state">
        <div class="spinner"></div>
        <p>Loading your trees...</p>
      </div>
    </div>
  </main>

  <!-- Create Tree Wizard Modal -->
  <div id="createTreeModal" class="modal" style="display: none;">
    <div class="modal-dialog modal-wizard">
      <div class="modal-content">
        <div class="modal-header">
          <h3 id="wizardTitle">Create Your Family Tree</h3>
          <button class="modal-close" id="closeCreateModal">&times;</button>
        </div>
        
        <!-- Step 1: Center Person -->
        <div id="step1" class="wizard-step active">
          <div class="modal-body">
            <h4 class="step-heading">Who Is the Central Person?</h4>
            <p class="step-subtitle">Choose who this tree is centered around.</p>
            <div class="form-group">
              <label class="form-label">Center this tree on:</label>
              <div class="radio-group">
                <label class="radio-label">
                  <input type="radio" name="centerMode" value="me" checked />
                  <span>Me</span>
                </label>
                <label class="radio-label">
                  <input type="radio" name="centerMode" value="other" />
                  <span>Someone else</span>
                </label>
              </div>
            </div>
            <div class="form-group">
              <label class="form-label">Do you want to add countries visited by family members?</label>
              <div class="radio-group">
                <label class="radio-label">
                  <input type="radio" name="enableGlobeCountries" value="yes" checked />
                  <span>Yes</span>
                </label>
                <label class="radio-label">
                  <input type="radio" name="enableGlobeCountries" value="no" />
                  <span>No</span>
                </label>
              </div>
              <p class="field-info">If enabled, you can create an interactive globe and see where your family has been.</p>
            </div>
            <div class="form-group">
              <label class="form-label">Do you want to add birthdays?</label>
              <div class="radio-group">
                <label class="radio-label">
                  <input type="radio" name="enableBirthdays" value="yes" checked />
                  <span>Yes</span>
                </label>
                <label class="radio-label">
                  <input type="radio" name="enableBirthdays" value="no" />
                  <span>No</span>
                </label>
              </div>
              <p class="field-info">If enabled, birthdays can be used for calendar view and birthday notifications.</p>
            </div>
          </div>
        </div>

        <!-- Step 2: Tree + Central Person -->
        <div id="step2" class="wizard-step">
          <div class="modal-body">
            <h4 class="step-heading" id="step2Heading">About You</h4>
            <p class="step-subtitle" id="step2Subtitle">Add tree details and the central person's information.</p>

            <div class="form-group">
              <label class="form-label" for="treeName">Family Tree Name <span class="required">*</span></label>
              <div id="treeNameError" class="form-error" style="display: none;">Family tree name is required</div>
              <input type="text" class="form-input" id="treeName" required placeholder="e.g., Smith Family Tree" />
            </div>
            <div class="form-group">
              <label class="form-label" for="treeDescription">Description (Optional)</label>
              <textarea class="form-input" id="treeDescription" rows="3" placeholder="Brief description of this family tree"></textarea>
            </div>
            <div class="form-group">
              <label class="form-label">Privacy</label>
              <div class="radio-group radio-group-inline">
                <label class="radio-label">
                  <input type="radio" name="privacy" value="private" checked />
                  <span>Private</span>
                </label>
                <label class="radio-label">
                  <input type="radio" name="privacy" value="public" />
                  <span>Public</span>
                </label>
              </div>
            </div>

            <div class="form-group">
              <label class="form-label" id="centralNameLabel">Your full name <span class="required">*</span></label>
              <div id="centralPersonNameError" class="form-error" style="display: none;">First name and last name are required</div>
              <div class="name-input-row">
                <div class="name-input-group">
                  <label class="form-label name-sub-label" for="centralPersonFirstName">First Name <span class="required">*</span></label>
                  <input type="text" class="form-input" id="centralPersonFirstName" required placeholder="First name" />
                </div>
                <div class="name-input-group">
                  <label class="form-label name-sub-label" for="centralPersonLastName">Last Name <span class="required">*</span></label>
                  <input type="text" class="form-input" id="centralPersonLastName" required placeholder="Last name" />
                </div>
              </div>
            </div>
            <div class="form-group" id="centralBirthdateGroup">
              <div class="form-label-row">
                <label class="form-label name-sub-label" for="centralBirthdate">Birthdate (Optional)</label>
                <button
                  type="button"
                  class="info-btn"
                  id="birthdateInfoBtn"
                  aria-label="Birthdate help"
                  aria-expanded="false"
                  aria-controls="birthdateInfo"
                >?</button>
              </div>
              <input type="text" class="form-input" id="centralBirthdate" placeholder="06/01/1950" maxlength="10" inputmode="numeric" />
              <p class="field-info" id="birthdateInfo" style="display: none;">Birthdate enables birthday calendar and birthday notifications.</p>
            </div>
            <div class="form-group">
              <label class="form-label" for="centralPhotoUrl">Photo URL (Optional)</label>
              <input type="url" class="form-input" id="centralPhotoUrl" placeholder="https://example.com/photo.jpg" />
            </div>

            <div class="form-group" id="relationshipGroup" style="display: none;">
              <label class="form-label" for="creatorRelationship">Your relationship to this person (Optional)</label>
              <select class="form-input" id="creatorRelationship">
                <option value="">Select relationship</option>
                <option value="my_father">My father</option>
                <option value="my_mother">My mother</option>
                <option value="my_spouse">My spouse</option>
                <option value="my_child">My child</option>
                <option value="my_grandparent">My grandparent</option>
                <option value="my_friend">My friend</option>
                <option value="other">Other</option>
              </select>
            </div>
            <div class="form-group" id="relationshipOtherGroup" style="display: none;">
              <label class="form-label" for="creatorRelationshipOther">Custom relationship (Optional)</label>
              <input type="text" class="form-input" id="creatorRelationshipOther" placeholder="Describe your relationship" />
            </div>
          </div>
        </div>

        <!-- Step 3: Parents -->
        <div id="step3" class="wizard-step">
          <div class="modal-body">
            <h4 class="step-heading" id="step3Heading">Parents</h4>
            <p class="step-subtitle" id="step3Subtitle">Add parent names and birthdates (you can skip unknown information).</p>

            <div class="form-group">
              <label class="form-label" id="fatherNameLabel">Father's full name</label>
              <div class="name-input-row">
                <div class="name-input-group">
                  <label class="form-label name-sub-label" for="fatherFirstName">First Name</label>
                  <input type="text" class="form-input" id="fatherFirstName" placeholder="Optional" />
                </div>
                <div class="name-input-group">
                  <label class="form-label name-sub-label" for="fatherLastName">Last Name</label>
                  <input type="text" class="form-input" id="fatherLastName" placeholder="Optional" />
                </div>
              </div>
            </div>
            <div class="form-group" id="fatherBirthdateGroup">
              <label class="form-label name-sub-label" id="fatherBirthdateLabel" for="fatherBirthdate">Father's birthdate</label>
              <input type="text" class="form-input" id="fatherBirthdate" placeholder="06/01/1950" maxlength="10" inputmode="numeric" />
            </div>
            <div class="form-group">
              <label class="form-label" id="motherNameLabel">Mother's full name</label>
              <div class="name-input-row">
                <div class="name-input-group">
                  <label class="form-label name-sub-label" for="motherFirstName">First Name</label>
                  <input type="text" class="form-input" id="motherFirstName" placeholder="Optional" />
                </div>
                <div class="name-input-group">
                  <label class="form-label name-sub-label" for="motherLastName">Last Name</label>
                  <input type="text" class="form-input" id="motherLastName" placeholder="Optional" />
                </div>
              </div>
            </div>
            <div class="form-group" id="motherBirthdateGroup">
              <label class="form-label name-sub-label" id="motherBirthdateLabel" for="motherBirthdate">Mother's birthdate</label>
              <input type="text" class="form-input" id="motherBirthdate" placeholder="06/01/1950" maxlength="10" inputmode="numeric" />
            </div>
          </div>
        </div>

        <!-- Step 4: Siblings -->
        <div id="step4" class="wizard-step">
          <div class="modal-body">
            <h4 class="step-heading" id="step4Heading">Siblings</h4>
            <p class="step-subtitle" id="step4Subtitle">Add siblings if available.</p>

            <div class="form-group">
              <label class="form-label" id="siblingsQuestion">Do you have brothers or sisters?</label>
              <div class="radio-group">
                <label class="radio-label">
                  <input type="radio" name="hasSiblings" value="no" checked />
                  <span>No</span>
                </label>
                <label class="radio-label">
                  <input type="radio" name="hasSiblings" value="yes" />
                  <span>Yes</span>
                </label>
              </div>
            </div>

            <div class="conditional-block" id="siblingsBlock" style="display: none;">
              <div class="form-group">
                <label class="form-label" id="siblingsListLabel">Add siblings</label>
                <div id="siblingsList" class="person-list"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- Step 5: Partner + Children -->
        <div id="step5" class="wizard-step">
          <div class="modal-body">
            <h4 class="step-heading" id="step5Heading">Partner, Children, and Grandchildren</h4>
            <p class="step-subtitle" id="step5Subtitle">Add partner, children, and grandchildren details.</p>

            <div class="form-group">
              <label class="form-label" id="partnerNameLabel">Partner or spouse name</label>
              <div class="name-input-row">
                <div class="name-input-group">
                  <label class="form-label name-sub-label" for="partnerFirstName">First Name</label>
                  <input type="text" class="form-input" id="partnerFirstName" placeholder="Optional" />
                </div>
                <div class="name-input-group">
                  <label class="form-label name-sub-label" for="partnerLastName">Last Name</label>
                  <input type="text" class="form-input" id="partnerLastName" placeholder="Optional" />
                </div>
              </div>
            </div>

            <div class="form-group" id="partnerBirthdateGroup">
              <label class="form-label name-sub-label" id="partnerBirthdateLabel" for="partnerBirthdate">Partner or spouse birthdate</label>
              <input type="text" class="form-input" id="partnerBirthdate" placeholder="06/01/1950" maxlength="10" inputmode="numeric" />
            </div>

            <div class="form-group">
              <label class="form-label" id="childrenQuestion">Do you have children?</label>
              <div class="radio-group">
                <label class="radio-label">
                  <input type="radio" name="hasChildren" value="no" checked />
                  <span>No</span>
                </label>
                <label class="radio-label">
                  <input type="radio" name="hasChildren" value="yes" />
                  <span>Yes</span>
                </label>
              </div>
            </div>

            <div class="conditional-block" id="childrenBlock" style="display: none;">
              <div class="form-group">
                <label class="form-label" id="childrenListLabel">Add children</label>
                <div id="childrenList" class="person-list"></div>
              </div>
            </div>

            <div class="form-group" id="grandchildrenQuestionGroup" style="display: none;">
              <label class="form-label" id="grandchildrenQuestion">Do you have grandchildren?</label>
              <div class="radio-group">
                <label class="radio-label">
                  <input type="radio" name="hasGrandchildren" value="no" checked />
                  <span>No</span>
                </label>
                <label class="radio-label">
                  <input type="radio" name="hasGrandchildren" value="yes" />
                  <span>Yes</span>
                </label>
              </div>
            </div>

            <div class="conditional-block" id="grandchildrenBlock" style="display: none;">
              <div class="form-group">
                <label class="form-label" id="grandchildrenListLabel">Add grandchildren</label>
                <div id="grandchildrenList" class="person-list"></div>
              </div>
            </div>
          </div>
        </div>

        <div class="wizard-nav">
          <button type="button" class="btn-secondary wizard-nav-btn" id="wizardBackBtn">Cancel</button>
          <div class="wizard-progress">
            <div class="progress-step active" data-step="1">1</div>
            <div class="progress-step" data-step="2">2</div>
            <div class="progress-step" data-step="3">3</div>
            <div class="progress-step" data-step="4">4</div>
            <div class="progress-step" data-step="5">5</div>
          </div>
          <button type="button" class="btn-primary wizard-nav-btn" id="wizardNextBtn">Next</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Delete Confirmation Modal -->
  <div id="deleteModal" class="modal" style="display: none;">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Delete Family Tree?</h3>
          <button class="modal-close" id="closeDeleteModal">&times;</button>
        </div>
        <div class="modal-body">
          <p>Are you sure you want to delete "<span id="deleteTreeName"></span>"?</p>
          <p class="warning-text">This action cannot be undone.</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn-secondary" id="cancelDeleteBtn">Cancel</button>
          <button type="button" class="btn-danger" id="confirmDeleteBtn">Delete</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Firebase SDK -->
  <script src="../scripts/runtime.js"></script>
  <script src="../scripts/night-sky.js"></script>
  <script src="../scripts/day-clouds.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
  <script src="../scripts/theme-toggle.js"></script>
  <script src="../scripts/dom-display.js"></script>
  <script src="../scripts/firebase-config.js?v=5"></script>
  <script src="../scripts/store-utils.js"></script>
  <script src="../scripts/dashboard.js?v=4"></script>
  <script
    type="text/plain"
    data-consent="optional"
    data-name="BMC-Widget"
    data-cfasync="false"
    data-src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js"
    data-id="paulsuatean"
    data-description="Support me on Buy me a coffee!"
    data-message=""
    data-color="#FFDD00"
    data-position="Right"
    data-x_margin="18"
    data-y_margin="18"
  ></script>
  <script src="../scripts/cookie-consent.js"></script>
</body>
</html>
